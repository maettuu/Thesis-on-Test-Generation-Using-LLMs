it("should handle invalid fontFile without throwing peekBytes error", async () => {
  const { PartialEvaluator } = await import("../../src/core/evaluator.js");
  const { Dict } = await import("../../src/core/primitives.js");

  // Mock font descriptor that returns a Dict instead of Stream
  const descriptor = {
    get: () => new Dict()
  };

  // Create evaluator with ignoreErrors option to prevent exceptions
  const evaluator = new PartialEvaluator({
    ignoreErrors: true
  });

  // Test translation without the patch would throw, with patch it should handle
  const result = await evaluator.translateFont(descriptor, "fontName", null);

  // Assert that evaluator didn't create NullStream and handled error properly
  expect(result).toBeUndefined();
});