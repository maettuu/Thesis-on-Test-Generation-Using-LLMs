it("should throw FormatError when fontFile is not a Stream", async () => {
  const { Dict, Name, FormatError, PartialEvaluator, XRefMock } = await import("../../src/core/evaluator.js");
  const xref = new XRefMock();
  const evaluator = new PartialEvaluator({
    xref,
    handler: null,
    pageIndex: 0,
    idFactory: createIdFactory(),
    fontCache: new Map(),
    builtInCMapCache: new Map(),
    standardFontDataCache: new Map(),
    globalImageCache: new Map(),
    systemFontCache: new Map(),
    options: { ignoreErrors: false }
  });

  const fontRef = { ref: { num: 1, gen: 0 } };
  xref.fetch.mockResolvedValueOnce(new Dict());

  await expect(evaluator.loadFont("TestFont", fontRef, null, null, null)).toThrow(
    FormatError
  );
});