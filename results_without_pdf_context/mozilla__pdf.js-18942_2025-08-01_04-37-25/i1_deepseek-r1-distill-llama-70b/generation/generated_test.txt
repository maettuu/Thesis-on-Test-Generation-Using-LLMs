it("should throw FormatError when fontFile is not a Stream", async () => {
  const { PartialEvaluator, Dict, Name, FormatError } = await import("../../src/core/evaluator.js");
  const xref = new XRefMock();
  const evaluator = new PartialEvaluator({
    xref,
    handler: null,
    pageIndex: 0,
    idFactory: createIdFactory(),
    fontCache: null,
    builtInCMapCache: null,
    standardFontDataCache: null,
    globalImageCache: null,
    systemFontCache: null,
    options: { ignoreErrors: false }
  });

  const descriptor = new Dict();
  descriptor.set("FontFile", new Dict()); // Not a Stream

  await expect(evaluator.translateFont({
    descriptor,
    dict: new Dict(),
    baseDict: new Dict(),
    composite: false,
    type: "Type3",
    firstChar: 0,
    lastChar: 0,
    toUnicode: null,
    cssFontInfo: null
  })).rejects.toThrow(FormatError);
});