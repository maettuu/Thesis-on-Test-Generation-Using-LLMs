it("should read highlighted text during editing inside a PDF", async () => {
  const { HighlightEditor } = await import("../../src/display/editor/highlight.js");
  const { AnnotationEditorUIManager } = await import("../../src/display/editor/tools.js");
  const { EventBus } = await import("../../web/event_utils.js");

  const eventBus = new EventBus();
  const uiManager = new AnnotationEditorUIManager(null, null, null, eventBus, null, null, "yellow=Yellow,green=Green");
  HighlightEditor.initialize(null, uiManager);

  const params = {
    color: "yellow",
    opacity: 1,
    boxes: [{ x: 0, y: 0, width: 1, height: 1 }],
    anchorNode: document.createTextNode("highlighted text"),
    anchorOffset: 0,
    focusNode: document.createTextNode("highlighted text"),
    focusOffset: 16,
    text: "highlighted text"
  };

  const editor = new HighlightEditor(params);
  const div = editor.render();
  document.body.appendChild(div);

  const mark = div.querySelector("mark");
  const isAriaHidden = mark.getAttribute("aria-hidden") === "true";
  const isTextVisible = window.getComputedStyle(mark).visibility !== "hidden";

  document.body.removeChild(div);

  expect(isAriaHidden).toBe(false);
  expect(isTextVisible).toBe(true);
});