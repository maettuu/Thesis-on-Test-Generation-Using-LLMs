it("should make highlighted text accessible to Voice Over", async () => {
  const { AnnotationEditorUIManager } = await import("../../src/display/editor/tools.js");
  const { HighlightEditor } = await import("../../src/display/editor/highlight.js");
  const { EventBus } = await import("../../web/event_utils.js");

  const eventBus = new EventBus();
  const container = document.createElement("div");
  const viewer = document.createElement("div");
  const pdfDocument = { annotationStorage: {}, filterFactory: {} };
  const uiManager = new AnnotationEditorUIManager(container, viewer, null, eventBus, pdfDocument, null, null, null);

  const textLayer = document.createElement("div");
  textLayer.className = "textLayer";
  const textNode = document.createTextNode("Sample text");
  textLayer.appendChild(textNode);
  document.body.appendChild(textLayer);

  const selection = window.getSelection();
  const range = document.createRange();
  range.selectNodeContents(textNode);
  selection.removeAllRanges();
  selection.addRange(range);

  uiManager.highlightSelection();

  const highlightEditor = new HighlightEditor({
    anchorNode: textNode,
    anchorOffset: 0,
    focusNode: textNode,
    focusOffset: textNode.length,
    boxes: [],
    methodOfCreation: "",
  });

  const div = highlightEditor.render();
  const mark = div.querySelector("mark");
  const isTextAccessible = mark && mark.textContent === "Sample text" && mark.className === "visuallyHidden";

  expect(isTextAccessible).toBe(true);

  document.body.removeChild(textLayer);
});