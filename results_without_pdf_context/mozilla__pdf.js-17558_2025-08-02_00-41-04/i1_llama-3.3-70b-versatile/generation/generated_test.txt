it("should render emojis in PDFs", async () => {
  const { PDFDocument } = await import("../../src/core/document.js");
  const { createIdFactory } = await import("./test_utils.js");
  const { DefaultCMapReaderFactory, DefaultStandardFontDataFactory } = await import("../../src/display/api.js");
  const { StringStream } = await import("../../src/core/stream.js");
  const { Dict, Name, Ref } = await import("../../src/core/primitives.js");
  const { FakeUnicodeFont } = await import("../../src/core/default_appearance.js");

  const pdfDoc = await PDFDocument.load(await fetch("path_to_pdf_with_emojis.pdf").then(res => res.arrayBuffer()));
  const page = pdfDoc.getPage(1);
  const annotations = await page.getAnnotations();
  const freeTextAnnotation = annotations.find(annotation => annotation instanceof MarkupAnnotation);

  const font = new FakeUnicodeFont(createIdFactory(), "sans-serif");
  const appearance = font.createAppearance("Hello ðŸŒŽ", [0, 0, 100, 100], 0, 12, [0, 0, 0], 1);
  const expectedAppearance = appearance.dict.getString("Length");

  const actualAppearance = freeTextAnnotation.appearance.dict.getString("Length");
  expect(actualAppearance).toBeGreaterThan(0);
});