it("should save PDF annotations correctly on certain PDFs", async () => {
  const { PDFDocument } = await import("../../src/core/document.js");
  const { AnnotationStorage } = await import("../../src/display/annotation_storage.js");
  const { getDocument } = await import("../../src/display/api.js");

  const pdfUrl = "path/to/test/pdf/with/annotations.pdf";
  const loadingTask = getDocument(pdfUrl);
  const pdfDocument = await loadingTask.promise;
  const annotationStorage = new AnnotationStorage();

  const page = await pdfDocument.getPage(1);
  const annotations = await page.getAnnotations();
  annotations.forEach(annotation => {
    annotationStorage.setValue(annotation.id, { value: "Test annotation" });
  });

  const savedPdf = await pdfDocument.save({ annotationStorage });
  const savedDocument = await PDFDocument.load(savedPdf);
  const savedPage = await savedDocument.getPage(1);
  const savedAnnotations = await savedPage.getAnnotations();

  const expectedAnnotations = annotations.map(annotation => ({
    ...annotation,
    value: "Test annotation"
  }));

  expect(savedAnnotations).toEqual(expectedAnnotations);
});