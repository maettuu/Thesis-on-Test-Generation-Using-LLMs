it("should render the polyglot PDFMP file without errors", async () => {
  const { getDocument } = await import("../../src/display/api.js");
  const { PDFNodeStream } = await import("../../src/display/node_stream.js");
  const { buildGetDocumentParams } = await import("./test_utils.js");

  const url = "https://github.com/mozilla/pdf.js/files/12185373/issue16759.pdf";
  const loadingTask = getDocument(buildGetDocumentParams(url, { isNode: true, NativeImageDecoderSupport: 0 }));
  const pdfDocument = await loadingTask.promise;

  const page = await pdfDocument.getPage(1);
  const viewport = page.getViewport({ scale: 1.0 });

  const canvasFactory = new PDFNodeStream();
  const canvasAndContext = canvasFactory.create(viewport.width, viewport.height);
  const renderTask = page.render({
    canvasContext: canvasAndContext.context,
    viewport,
  });

  await renderTask.promise;
  expect(renderTask.operatorList.fnArray.length).toBeGreaterThan(0);
});