[2025-08-01 12:56:10] MARKER   : =============== Running Payload #18369 ===============
[2025-08-01 12:56:10] MARKER   : ================ Preparing Environment ===============
[2025-08-01 12:56:10] WARNING  : No GitHub issue found
[2025-08-01 12:56:10] SUCCESS  : Linked Bugzilla issue #1905623 fetched successfully
[2025-08-01 12:56:13] WARNING  : No PDF file available
[2025-08-01 12:56:14] INFO     : Cloning repository https://github.com/mozilla/pdf.js.git
[2025-08-01 12:56:22] SUCCESS  : Cloning successful
[2025-08-01 12:56:22] INFO     : Fetching test file for injection...
[2025-08-01 12:56:24] SUCCESS  : Test file test/unit/api_spec.js fetched successfully
[2025-08-01 12:56:25] WARNING  : No existing image 'image_mozilla__pdf.js-18369' found
[2025-08-01 12:56:25] INFO     : Building from scratch based on commit ccad2f889ae8e721b1a1119190f03f99c68ae763
[2025-08-01 13:01:13] SUCCESS  : Docker image 'image_mozilla__pdf.js-18369' built successfully
[2025-08-01 13:01:13] MARKER   : ================ Preparation Complete ================
[2025-08-01 13:01:13] MARKER   : Attempt 1 with model gpt-4o
[2025-08-01 13:01:13] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:01:13] INFO     : Querying LLM...
[2025-08-01 13:01:25] INFO     : HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:01:25] SUCCESS  : LLM response received
[2025-08-01 13:01:25] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:01:25] INFO     : Creating container...
[2025-08-01 13:01:26] SUCCESS  : Container ef2d6aca4b9b started
[2025-08-01 13:01:27] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:01:27] CRITICAL : Failed to apply patch: patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line
patch: **** malformed patch at line 21:  


[2025-08-01 13:01:27] WARNING  : Stopping and removing container...
[2025-08-01 13:01:38] SUCCESS  : Container stopped and removed
[2025-08-01 13:01:38] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:01:38] MARKER   : Attempt 2 with model gpt-4o
[2025-08-01 13:01:38] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:01:38] INFO     : Querying LLM...
[2025-08-01 13:01:43] INFO     : HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:01:43] SUCCESS  : LLM response received
[2025-08-01 13:01:43] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:01:43] INFO     : Creating container...
[2025-08-01 13:01:45] SUCCESS  : Container dc85834b9e78 started
[2025-08-01 13:01:45] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:01:45] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:01:45] INFO     : Running test command...
[2025-08-01 13:02:13] SUCCESS  : Test command executed
[2025-08-01 13:02:13] FAIL     : Test evaluated as failed
[2025-08-01 13:02:13] WARNING  : Stopping and removing container...
[2025-08-01 13:02:24] SUCCESS  : Container stopped and removed
[2025-08-01 13:02:24] MARKER   : Running test in post-PR codebase...
[2025-08-01 13:02:24] INFO     : Creating container...
[2025-08-01 13:02:26] SUCCESS  : Container 64918870ad63 started
[2025-08-01 13:02:26] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:02:26] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:02:26] SUCCESS  : File golden_code_patch.diff added to container successfully
[2025-08-01 13:02:26] SUCCESS  : Patch file golden_code_patch.diff applied successfully
[2025-08-01 13:02:26] INFO     : Running test command...
[2025-08-01 13:02:53] SUCCESS  : Test command executed
[2025-08-01 13:02:53] INFO     : Test evaluated as passed
[2025-08-01 13:02:53] WARNING  : Stopping and removing container...
[2025-08-01 13:03:08] SUCCESS  : Container stopped and removed
[2025-08-01 13:03:08] SUCCESS  : Fail-to-Pass test generated
[2025-08-01 13:03:08] SUCCESS  : Suggested test for PR:


Hi! ðŸ¤– The test below is automatically generated and serves as a regression test for this PR because it:
- passes in the new codebase after the PR, and
- fails in the old codebase before the PR.

```javascript
it("should use vertical variant of a char when its in a missing vertical font", async () => {
  const { Font } = await import("../../src/core/fonts.js");
  const { getVerticalPresentationForm } = await import("../../src/core/fonts_utils.js");

  const properties = {
    loadedName: "TestFont",
    isType3Font: false,
    cssFontInfo: null,
    flags: 0,
    type: "CIDFontType0",
    subtype: "Type1C",
    differences: [],
    widths: [],
    defaultWidth: 1000,
    composite: false,
    cMap: null,
    capHeight: 700,
    ascent: 800,
    descent: -200,
    fontMatrix: [0.001, 0, 0, 0.001, 0, 0],
    bbox: [0, 0, 1000, 1000],
    defaultEncoding: [],
    toUnicode: new Map(),
    vertical: true,
    vmetrics: [],
    defaultVMetrics: [],
  };

  const font = new Font("TestFont", null, properties);
  font.missingFile = true;

  const charCode = 0x3001; // IDEOGRAPHIC COMMA
  const expected = String.fromCharCode(getVerticalPresentationForm()[charCode]);

  const glyph = font._charToGlyph(charCode);
  const actual = glyph.unicode;

  expect(actual).toBe(expected);
});
```

If you find this regression test useful, feel free to insert it to your test suite.
Our automated pipeline inserted the test in the `test/unit/api_spec.js` file before running it.

This is part of our research at the [ZEST](https://www.ifi.uzh.ch/en/zest.html) group of University of Zurich in collaboration with [Mozilla](https://www.mozilla.org).
If you have any suggestions, questions, or simply want to learn more, feel free to contact us at konstantinos.kitsios@uzh.ch and mcastelluccio@mozilla.com.

[2025-08-01 13:03:08] MARKER   : =============== Test Generation Finished =============
[2025-08-01 13:03:08] SUCCESS  : Attempt 2 with model gpt-4o finished successfully
[2025-08-01 13:03:08] SUCCESS  : Test file copied to generated_tests/pdf_js_18369_i2_gpt-4o.txt
[2025-08-01 13:03:08] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:03:08] MARKER   : Attempt 1 with model llama-3.3-70b-versatile
[2025-08-01 13:03:08] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:03:08] INFO     : Querying LLM...
[2025-08-01 13:03:09] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:03:09] SUCCESS  : LLM response received
[2025-08-01 13:03:10] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:03:10] INFO     : Creating container...
[2025-08-01 13:03:12] SUCCESS  : Container ac53c0b99a7d started
[2025-08-01 13:03:12] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:03:12] CRITICAL : Failed to apply patch: patch: **** malformed patch at line 24:  

patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line

[2025-08-01 13:03:12] WARNING  : Stopping and removing container...
[2025-08-01 13:03:23] SUCCESS  : Container stopped and removed
[2025-08-01 13:03:23] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:03:23] MARKER   : Attempt 2 with model llama-3.3-70b-versatile
[2025-08-01 13:03:23] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:03:23] INFO     : Querying LLM...
[2025-08-01 13:03:24] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:03:24] SUCCESS  : LLM response received
[2025-08-01 13:03:24] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:03:24] INFO     : Creating container...
[2025-08-01 13:03:26] SUCCESS  : Container 4650df80da8e started
[2025-08-01 13:03:26] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:03:26] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:03:26] INFO     : Running test command...
[2025-08-01 13:03:53] SUCCESS  : Test command executed
[2025-08-01 13:03:53] FAIL     : Test evaluated as failed
[2025-08-01 13:03:53] WARNING  : Stopping and removing container...
[2025-08-01 13:04:05] SUCCESS  : Container stopped and removed
[2025-08-01 13:04:05] MARKER   : Running test in post-PR codebase...
[2025-08-01 13:04:05] INFO     : Creating container...
[2025-08-01 13:04:06] SUCCESS  : Container 705a484f0564 started
[2025-08-01 13:04:06] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:04:06] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:04:06] SUCCESS  : File golden_code_patch.diff added to container successfully
[2025-08-01 13:04:06] SUCCESS  : Patch file golden_code_patch.diff applied successfully
[2025-08-01 13:04:06] INFO     : Running test command...
[2025-08-01 13:04:35] SUCCESS  : Test command executed
[2025-08-01 13:04:35] FAIL     : Test evaluated as failed
[2025-08-01 13:04:35] WARNING  : Stopping and removing container...
[2025-08-01 13:04:46] SUCCESS  : Container stopped and removed
[2025-08-01 13:04:46] FAIL     : No Fail-to-Pass test generated
[2025-08-01 13:04:46] MARKER   : =============== Test Generation Finished =============
[2025-08-01 13:04:46] SUCCESS  : Attempt 2 with model llama-3.3-70b-versatile finished successfully
[2025-08-01 13:04:46] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:04:46] MARKER   : Attempt 3 with model llama-3.3-70b-versatile
[2025-08-01 13:04:46] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:04:46] INFO     : Querying LLM...
[2025-08-01 13:04:50] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:04:50] SUCCESS  : LLM response received
[2025-08-01 13:04:50] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:04:50] INFO     : Creating container...
[2025-08-01 13:04:51] SUCCESS  : Container f9d250ffd2f0 started
[2025-08-01 13:04:51] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:04:52] CRITICAL : Failed to apply patch: patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line
patch: **** malformed patch at line 35:  


[2025-08-01 13:04:52] WARNING  : Stopping and removing container...
[2025-08-01 13:05:02] SUCCESS  : Container stopped and removed
[2025-08-01 13:05:02] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:05:02] MARKER   : Attempt 4 with model llama-3.3-70b-versatile
[2025-08-01 13:05:02] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:05:02] INFO     : Querying LLM...
[2025-08-01 13:05:06] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:05:06] SUCCESS  : LLM response received
[2025-08-01 13:05:06] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:05:06] INFO     : Creating container...
[2025-08-01 13:05:08] SUCCESS  : Container eeab47ecd169 started
[2025-08-01 13:05:09] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:05:09] CRITICAL : Failed to apply patch: patch: **** malformed patch at line 22:  

patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line

[2025-08-01 13:05:09] WARNING  : Stopping and removing container...
[2025-08-01 13:05:20] SUCCESS  : Container stopped and removed
[2025-08-01 13:05:20] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:05:20] MARKER   : Attempt 5 with model llama-3.3-70b-versatile
[2025-08-01 13:05:20] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:05:20] INFO     : Querying LLM...
[2025-08-01 13:05:21] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:05:21] SUCCESS  : LLM response received
[2025-08-01 13:05:21] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:05:21] INFO     : Creating container...
[2025-08-01 13:05:22] SUCCESS  : Container ff92d66d6ac9 started
[2025-08-01 13:05:22] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:05:22] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:05:22] INFO     : Running test command...
[2025-08-01 13:05:51] SUCCESS  : Test command executed
[2025-08-01 13:05:51] FAIL     : Test evaluated as failed
[2025-08-01 13:05:51] WARNING  : Stopping and removing container...
[2025-08-01 13:06:02] SUCCESS  : Container stopped and removed
[2025-08-01 13:06:02] MARKER   : Running test in post-PR codebase...
[2025-08-01 13:06:02] INFO     : Creating container...
[2025-08-01 13:06:03] SUCCESS  : Container 81633718c8a8 started
[2025-08-01 13:06:03] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:06:03] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:06:03] SUCCESS  : File golden_code_patch.diff added to container successfully
[2025-08-01 13:06:03] SUCCESS  : Patch file golden_code_patch.diff applied successfully
[2025-08-01 13:06:03] INFO     : Running test command...
[2025-08-01 13:06:30] SUCCESS  : Test command executed
[2025-08-01 13:06:30] FAIL     : Test evaluated as failed
[2025-08-01 13:06:30] WARNING  : Stopping and removing container...
[2025-08-01 13:06:41] SUCCESS  : Container stopped and removed
[2025-08-01 13:06:41] FAIL     : No Fail-to-Pass test generated
[2025-08-01 13:06:41] MARKER   : =============== Test Generation Finished =============
[2025-08-01 13:06:41] SUCCESS  : Attempt 5 with model llama-3.3-70b-versatile finished successfully
[2025-08-01 13:06:41] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:06:41] MARKER   : Attempt 1 with model deepseek-r1-distill-llama-70b
[2025-08-01 13:06:41] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:06:41] INFO     : Querying LLM...
[2025-08-01 13:06:46] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:06:46] SUCCESS  : LLM response received
[2025-08-01 13:06:46] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:06:46] INFO     : Creating container...
[2025-08-01 13:06:47] SUCCESS  : Container 578a96010646 started
[2025-08-01 13:06:47] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:06:48] CRITICAL : Failed to apply patch: patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line
patch: **** malformed patch at line 25:  


[2025-08-01 13:06:48] WARNING  : Stopping and removing container...
[2025-08-01 13:06:58] SUCCESS  : Container stopped and removed
[2025-08-01 13:06:58] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:06:58] MARKER   : Attempt 2 with model deepseek-r1-distill-llama-70b
[2025-08-01 13:06:58] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:06:58] INFO     : Querying LLM...
[2025-08-01 13:07:02] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:07:02] SUCCESS  : LLM response received
[2025-08-01 13:07:02] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:07:02] INFO     : Creating container...
[2025-08-01 13:07:04] SUCCESS  : Container fc8734f7aa32 started
[2025-08-01 13:07:04] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:07:05] CRITICAL : Failed to apply patch: patch: **** malformed patch at line 34:  

patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line

[2025-08-01 13:07:05] WARNING  : Stopping and removing container...
[2025-08-01 13:07:15] SUCCESS  : Container stopped and removed
[2025-08-01 13:07:15] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:07:15] MARKER   : Attempt 3 with model deepseek-r1-distill-llama-70b
[2025-08-01 13:07:15] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:07:15] INFO     : Querying LLM...
[2025-08-01 13:07:23] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:07:23] SUCCESS  : LLM response received
[2025-08-01 13:07:23] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:07:23] INFO     : Creating container...
[2025-08-01 13:07:24] SUCCESS  : Container 39183ab10fac started
[2025-08-01 13:07:24] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:07:24] CRITICAL : Failed to apply patch: patch: **** malformed patch at line 35:  

patching file test/unit/api_spec.js
patch unexpectedly ends in middle of line

[2025-08-01 13:07:24] WARNING  : Stopping and removing container...
[2025-08-01 13:07:35] SUCCESS  : Container stopped and removed
[2025-08-01 13:07:35] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:07:35] MARKER   : Attempt 4 with model deepseek-r1-distill-llama-70b
[2025-08-01 13:07:35] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:07:35] INFO     : Querying LLM...
[2025-08-01 13:07:42] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:07:42] SUCCESS  : LLM response received
[2025-08-01 13:07:42] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:07:42] INFO     : Creating container...
[2025-08-01 13:07:44] SUCCESS  : Container 02838dfdd09c started
[2025-08-01 13:07:44] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:07:44] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:07:44] INFO     : Running test command...
[2025-08-01 13:08:12] SUCCESS  : Test command executed
[2025-08-01 13:08:12] FAIL     : Test evaluated as failed
[2025-08-01 13:08:12] WARNING  : Stopping and removing container...
[2025-08-01 13:08:23] SUCCESS  : Container stopped and removed
[2025-08-01 13:08:23] MARKER   : Running test in post-PR codebase...
[2025-08-01 13:08:23] INFO     : Creating container...
[2025-08-01 13:08:24] SUCCESS  : Container 8e0e798fa2b2 started
[2025-08-01 13:08:25] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:08:25] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:08:25] SUCCESS  : File golden_code_patch.diff added to container successfully
[2025-08-01 13:08:25] SUCCESS  : Patch file golden_code_patch.diff applied successfully
[2025-08-01 13:08:25] INFO     : Running test command...
[2025-08-01 13:08:52] SUCCESS  : Test command executed
[2025-08-01 13:08:52] FAIL     : Test evaluated as failed
[2025-08-01 13:08:52] WARNING  : Stopping and removing container...
[2025-08-01 13:09:03] SUCCESS  : Container stopped and removed
[2025-08-01 13:09:03] FAIL     : No Fail-to-Pass test generated
[2025-08-01 13:09:03] MARKER   : =============== Test Generation Finished =============
[2025-08-01 13:09:03] SUCCESS  : Attempt 4 with model deepseek-r1-distill-llama-70b finished successfully
[2025-08-01 13:09:03] INFO     : Environment ready â€“ preparation skipped
[2025-08-01 13:09:03] MARKER   : Attempt 5 with model deepseek-r1-distill-llama-70b
[2025-08-01 13:09:03] MARKER   : =============== Test Generation Started ==============
[2025-08-01 13:09:03] INFO     : Querying LLM...
[2025-08-01 13:09:07] INFO     : HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-08-01 13:09:07] SUCCESS  : LLM response received
[2025-08-01 13:09:07] MARKER   : Running test in pre-PR codebase...
[2025-08-01 13:09:07] INFO     : Creating container...
[2025-08-01 13:09:08] SUCCESS  : Container 56fb89e65e74 started
[2025-08-01 13:09:09] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:09:09] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:09:09] INFO     : Running test command...
[2025-08-01 13:09:36] SUCCESS  : Test command executed
[2025-08-01 13:09:36] FAIL     : Test evaluated as failed
[2025-08-01 13:09:36] WARNING  : Stopping and removing container...
[2025-08-01 13:09:47] SUCCESS  : Container stopped and removed
[2025-08-01 13:09:47] MARKER   : Running test in post-PR codebase...
[2025-08-01 13:09:47] INFO     : Creating container...
[2025-08-01 13:09:48] SUCCESS  : Container 096c12975153 started
[2025-08-01 13:09:49] SUCCESS  : File test_patch.diff added to container successfully
[2025-08-01 13:09:49] SUCCESS  : Patch file test_patch.diff applied successfully
[2025-08-01 13:09:49] SUCCESS  : File golden_code_patch.diff added to container successfully
[2025-08-01 13:09:49] SUCCESS  : Patch file golden_code_patch.diff applied successfully
[2025-08-01 13:09:49] INFO     : Running test command...
[2025-08-01 13:10:17] SUCCESS  : Test command executed
[2025-08-01 13:10:17] FAIL     : Test evaluated as failed
[2025-08-01 13:10:17] WARNING  : Stopping and removing container...
[2025-08-01 13:10:28] SUCCESS  : Container stopped and removed
[2025-08-01 13:10:28] FAIL     : No Fail-to-Pass test generated
[2025-08-01 13:10:28] MARKER   : =============== Test Generation Finished =============
[2025-08-01 13:10:28] SUCCESS  : Attempt 5 with model deepseek-r1-distill-llama-70b finished successfully
[2025-08-01 13:10:28] MARKER   : =============== Finished Payload #18369 ==============
[2025-08-01 13:10:28] SUCCESS  : Directory tmp_repo_dir_mozilla__pdf.js-18369 removed successfully
[2025-08-01 13:10:30] SUCCESS  : Removed Docker image 'image_mozilla__pdf.js-18369'
