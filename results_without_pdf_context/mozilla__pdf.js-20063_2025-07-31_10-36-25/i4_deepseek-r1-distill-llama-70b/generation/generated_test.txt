it("should render polygon annotation with fill and outline", async () => {
  const { PDFDocument, PDFViewer } = await import("../../web/pdf_viewer.js");
  const { AnnotationFactory } = await import("../../src/core/annotation.js");
  const { QuadPoints } = await import("../../src/core/quadpoints.js");

  // Create a test PDF with a polygon annotation
  const pdfData = new Uint8Array([
    37, 80, 68, 70, 45, 50, 34, 45, 53, 57, 34, 45, 52, 55, 52, 55, 52, 55, 34, 45,
    87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0,
    12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45,
    87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0,
    12, 57, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45,
    87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1,
    0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68,
    67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12,
    57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67,
    0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57,
    52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0,
    1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52,
    55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0,
    1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55,
    52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1,
    84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52,
    55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84,
    34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55,
    34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34,
    106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34,
    45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0,
    0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52,
    55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0,
    0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55,
    52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0,
    34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52,
    55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34,
    12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55,
    34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12,
    57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34,
    45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57,
    34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45,
    87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0,
    1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34,
    68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0,
    12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68,
    67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12,
    57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67,
    0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57,
    52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0,
    1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57,
    52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68, 67,
    0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12,
    57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87, 34, 68,
    67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34, 0, 1,
    0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45, 87,
    34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57, 34,
    0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34, 45,
    87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12, 57,
    34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55, 34,
    45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34, 12,
    57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52, 55,
    34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0, 34,
    12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55, 52,
    55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0, 0,
    34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52, 55,
    52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0, 0,
    0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45, 52,
    55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106, 0,
    0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57, 52, 55, 52, 55, 34, 45,
    52, 55, 52, 55, 34, 45, 87, 34, 68, 67, 0, 1, 0, 1, 84, 34, 106,
    0, 0, 0, 34, 12, 57, 34, 0, 1, 0, 12, 57,