it("should use ceil for noninteger DW values", async () => {
  const { PartialEvaluator } = await import("../../src/core/evaluator.js");

  const xref = {
    fetchIfRef: (value) => value
  };

  const dict = {
    get: (key) => {
      if (key === "DW") return 500.5;
      if (key === "W") return [1, 2, 3];
      return null;
    },
    getArray: () => null
  };

  const properties = {
    composite: true,
    vertical: false,
    firstChar: 0
  };

  const evaluator = new PartialEvaluator({
    xref,
    handler: null,
    pageIndex: 0,
    idFactory: null,
    fontCache: null,
    builtInCMapCache: null,
    standardFontDataCache: null,
    globalImageCache: null,
    systemFontCache: null,
    options: null
  });

  evaluator.extractWidths(dict, {}, properties);

  expect(properties.defaultWidth).toBe(501);
});