it("should use ImageDecoder for faster image decoding", async () => {
  const { JpegStream } = await import("../../src/core/jpeg_stream.js");
  const { BaseStream } = await import("../../src/core/base_stream.js");

  // Sample JPEG data in base64
  const jpegData = "data:image/jpeg;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxIDEgMTAwIj48cG9seWdvbiBwb2ludHM9IjUwLDAgMTAwIDUwIiBwb2lkdHM9IjUwIDMwIDUwIDMwIiBmaWxsPSIjMDAwIi8+PC9zdmc+";

  // Create a buffer from the base64 data
  const buffer = Buffer.from(jpegData.split(',')[1], 'base64');

  class MockStream extends BaseStream {
    get bytes() {
      return this.buffer;
    }
  }

  const stream = new MockStream();
  stream.buffer = buffer;

  const jpegStream = new JpegStream(stream, null, {});

  // Check if getTransferableImage is implemented and returns a bitmap
  const image = await jpegStream.getTransferableImage();

  expect(image).not.toBeNull();
});