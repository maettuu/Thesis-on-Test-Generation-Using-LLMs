it("should use correct font family on Windows and Firefox", async () => {
  const { TextLayer } = await import("../../src/display/text_layer.js");
  const { FeatureTest } = await import("../../src/shared/util.js");

  // Mock the platform detection to simulate Windows and Firefox
  const mockPlatform = {
    isWindows: true,
    isFirefox: true,
  };
  jest.spyOn(FeatureTest, "platform", "get").mockReturnValue(mockPlatform);

  // Create a test text layer
  const textLayer = new TextLayer({
    textContentSource: new ReadableStream({
      start(controller) {
        controller.enqueue("Test text");
        controller.close();
      },
    }),
    container: document.createElement("div"),
    viewport: {
      scale: 1,
      rawDims: { pageWidth: 100, pageHeight: 100 },
      rotation: 0,
    },
  });

  // Check the font family for sans-serif and monospace
  const fontFamilyMap = await TextLayer.fontFamilyMap;
  expect(fontFamilyMap.get("sans-serif")).toContain("Calibri");
  expect(fontFamilyMap.get("monospace")).toContain("Lucida Console");
});