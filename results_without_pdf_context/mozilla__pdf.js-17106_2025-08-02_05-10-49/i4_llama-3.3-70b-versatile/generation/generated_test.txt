it("should release ImageBitmap data after cleanup", async () => {
  const { PDFDocumentLoadingTask, PDFWorker } = await import("../../src/display/api.js");
  const { createIdFactory } = await import("./test_utils.js");
  const idFactory = createIdFactory();

  const worker = new PDFWorker();
  const loadingTask = await PDFDocumentLoadingTask.fromBytes(
    new Uint8Array([0x25, 0x50, 0x44, 0x46, 0x2d, 0x31, 0x2e, 0x34]),
    { worker }
  );

  const pdfDocument = await loadingTask.promise;
  const page = await pdfDocument.getPage(1);
  const image = await new Promise(resolve => {
    page.objs.on("Image", resolve);
  });

  await pdfDocument.cleanup();
  expect(image.bitmap?.close).toHaveBeenCalledTimes(1);
});