it("should correctly serialize highlight boxes with crop", async () => {
  const { HighlightEditor } = await import("../../src/display/editor/highlight.js");

  // Mock page dimensions to simulate a cropped page
  const pageDimensions = [100, 100]; // pageWidth, pageHeight
  const editor = new HighlightEditor({
    boxes: [{x: 0.5, y: 0.5, width: 0.2, height: 0.2}],
    pageDimensions: pageDimensions,
    x: 0.1,
    y: 0.1,
    width: 0.8,
    height: 0.8,
  });

  // Serialize boxes with crop
  const quadPoints = editor.#serializeBoxes([20, 30]); // tx=20, ty=30

  // Expected quadPoints after applying crop
  const expectedQuadPoints = [
    20 + 0.5 * 100,  // x
    30 + 0.5 * 100,  // y
    20 + (0.5 + 0.2) * 100, // x + width
    30 + 0.5 * 100,  // y
    20 + 0.5 * 100,  // x
    30 + (0.5 + 0.2) * 100, // y + height
    20 + (0.5 + 0.2) * 100, // x + width
    30 + (0.5 + 0.2) * 100  // y + height
  ];

  assert.deepEqual(quadPoints, expectedQuadPoints);
});