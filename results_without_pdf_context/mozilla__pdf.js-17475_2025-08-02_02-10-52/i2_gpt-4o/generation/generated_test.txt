it("should correctly serialize highlight boxes with crop box adjustments", async () => {
  const { HighlightEditor } = await import("../../src/display/editor/highlight.js");
  const { Util } = await import("../../src/shared/util.js");

  const pageDimensions = [600, 800];
  const rect = [50, 50, 550, 750];
  const color = [255, 255, 102];
  const quadPoints = [100, 700, 200, 700, 100, 600, 200, 600];
  const opacity = 1;
  const pageIndex = 0;

  const data = {
    rect,
    color,
    quadPoints,
    opacity,
    pageIndex,
  };

  const parent = null;
  const uiManager = { highlightColors: new Map([["default", "#fff066"]]) };

  const editor = HighlightEditor.deserialize(data, parent, uiManager);
  editor.pageDimensions = pageDimensions;

  const expectedQuadPoints = [150, 700, 250, 700, 150, 600, 250, 600];
  const actualQuadPoints = editor.serialize().quadPoints;

  expect(actualQuadPoints).toEqual(expectedQuadPoints);
});