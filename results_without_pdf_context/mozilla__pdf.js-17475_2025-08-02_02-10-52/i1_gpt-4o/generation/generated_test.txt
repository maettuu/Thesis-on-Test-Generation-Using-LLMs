it("should correctly serialize and deserialize highlight annotations with visible highlights on cropped PDFs", async () => {
  const { HighlightEditor } = await import("../../src/display/editor/highlight.js");
  const { Util } = await import("../../src/shared/util.js");

  const pageDimensions = [600, 800];
  const rect = [100, 100, 500, 700];
  const color = [255, 255, 0];
  const opacity = 0.5;
  const quadPoints = [100, 700, 500, 700, 100, 100, 500, 100];

  const data = {
    rect,
    color,
    opacity,
    quadPoints,
  };

  const parent = null;
  const uiManager = null;

  const editor = HighlightEditor.deserialize(data, parent, uiManager);
  editor.pageDimensions = pageDimensions;

  const serializedData = editor.serialize();
  const expectedColor = Util.makeHexColor(...color);

  expect(serializedData.color).toEqual(expectedColor);
  expect(serializedData.opacity).toEqual(opacity);
  expect(serializedData.quadPoints).toEqual(quadPoints);
  expect(serializedData.rect).toEqual(rect);
});