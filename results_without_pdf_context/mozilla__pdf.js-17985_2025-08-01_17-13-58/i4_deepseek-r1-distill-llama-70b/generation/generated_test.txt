it("should respect verbosity level when logging OpenJPEG warnings", async () => {
  const { JpxImage } = await import("../../src/core/jpx.js");
  const { setVerbosityLevel, VerbosityLevel } = await import("../../shared/util.js");

  const mockConsoleWarn = jest.fn();
  const originalConsoleWarn = console.warn;

  // Test with verbosity NONE
  setVerbosityLevel(VerbosityLevel.none);
  console.warn = mockConsoleWarn;
  const invalidJpxData = new Uint8Array([0x00, 0x00, 0x00, 0x00]); // Invalid JPX data to trigger warning
  await expect(JpxImage.decode(invalidJpxData)).rejects.toThrow(JpxError);
  expect(mockConsoleWarn).not.toHaveBeenCalled();
  console.warn = originalConsoleWarn;

  // Reset module for next test
  JpxImage.cleanup();

  // Test with verbosity WARNING
  setVerbosityLevel(VerbosityLevel.warning);
  console.warn = mockConsoleWarn;
  await expect(JpxImage.decode(invalidJpxData)).rejects.toThrow(JpxError);
  expect(mockConsoleWarn).toHaveBeenCalled();
  console.warn = originalConsoleWarn;
});