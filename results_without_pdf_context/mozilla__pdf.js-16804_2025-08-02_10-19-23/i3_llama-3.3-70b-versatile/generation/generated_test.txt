it("should remove embedded images from annotations", async () => {
  const xref = new XRefMock();
  const annotation = new Annotation({
    dict: new Dict(xref),
    xref,
    ref: new Ref(xref, 1),
    id: "test",
    subtype: "FileAttachment",
    pdfManager: {
      ensureCatalog: async () => {},
      ensureDoc: async () => {},
      xref,
    },
    evaluatorOptions: {},
  });
  annotation.data.fillAlpha = 0.5;
  const appearance = new StringStream("q 1 0 0 1 0 0 cm /Im0 Do Q");
  const appearanceDict = new Dict(xref);
  appearanceDict.set("Subtype", Name.get("Form"));
  appearanceDict.set("Type", Name.get("XObject"));
  appearanceDict.set("BBox", [0, 0, 100, 100]);
  appearanceDict.set("Matrix", [1, 0, 0, 1, 0, 0]);
  appearance.dict = appearanceDict;
  annotation.appearance = appearance;
  const trigger = document.createElement("div");
  trigger.classList.add("popupTriggerArea");
  const annotationElement = new AnnotationElement({
    data: annotation.data,
    layer: document.createElement("div"),
    linkService: {},
    downloadManager: {},
    imageResourcesPath: "",
    renderForms: true,
    svgFactory: {},
    annotationStorage: {},
  });
  annotationElement.render();
  const expectedStyle = `filter: opacity(50%);`;
  const actualStyle = annotationElement.container.style.filter;
  expect(actualStyle).toBe(expectedStyle);
});