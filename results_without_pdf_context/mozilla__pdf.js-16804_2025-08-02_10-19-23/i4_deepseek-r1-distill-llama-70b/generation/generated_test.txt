it("should hide embedded images when fillAlpha is set to", async () => {
  const { AnnotationFactory, Util } = await import("../../src/core/annotation.js");
  const { DOMSVGFactory } = await import("../../src/display_utils.js");

  // Create a sample annotation with fillAlpha set to 0
  const annotation = {
    subtype: "FileAttachment",
    rect: [0, 0, 100, 100],
    dict: {
      get: (key) => {
        if (key === "ca") return 0;
        return null;
      },
    },
  };

  // Render the annotation
  const svgFactory = new DOMSVGFactory();
  const container = document.createElement("div");
  const layer = {
    div: container,
    viewport: {
      rawDims: { pageWidth: 100, pageHeight: 100, pageX: 0, pageY: 0 },
    },
    linkService: {},
    downloadManager: {},
    imageResourcesPath: "",
    renderForms: false,
    annotationStorage: {},
    parent: { zIndex: 0 },
  };

  const elementParams = {
    data: annotation,
    layer: layer,
    linkService: {},
    downloadManager: {},
    imageResourcesPath: "",
    renderForms: false,
    svgFactory: svgFactory,
    annotationStorage: {},
    parent: layer,
  };

  const annotationElement = AnnotationElementFactory.create(elementParams);
  const rendered = annotationElement.render();

  // Check if the pin is hidden
  const pin = rendered.querySelector("img");
  expect(pin).not.toBeNull();
  expect(pin.style.opacity).toBe("0");
});