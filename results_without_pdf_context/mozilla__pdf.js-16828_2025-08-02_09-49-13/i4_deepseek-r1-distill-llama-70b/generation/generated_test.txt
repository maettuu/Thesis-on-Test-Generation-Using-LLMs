it("should create a StampEditor when pasting an image from clipboard", async () => {
  const { AnnotationEditorUIManager } = await import("../../src/display/editor/tools.js");
  const { AnnotationEditorLayer } = await import("../../src/display/editor/annotation_editor_layer.js");
  const { StampEditor } = await import("../../src/display/editor/stamp.js");

  const container = {
    focus: jest.fn(),
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
  };

  const mockViewer = {};
  const mockEventBus = {
    _on: jest.fn(),
    _off: jest.fn(),
    dispatch: jest.fn(),
  };
  const mockPdfDocument = {};
  const mockPageColors = {};

  const uiManager = new AnnotationEditorUIManager(
    container,
    mockViewer,
    mockEventBus,
    mockPdfDocument,
    mockPageColors
  );

  const mockClipboardEvent = {
    clipboardData: {
      getData: () => "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",
    },
    preventDefault: jest.fn(),
  };

  // Before patch: should not create StampEditor
  const beforePatchResult = await import("../../src/display/editor/tools.js");
  expect(beforePatchResult.AnnotationEditorUIManager.paste(mockClipboardEvent)).not.toCreate(StampEditor);

  // After patch: should create StampEditor
  const afterPatchResult = await import("../../src/display/editor/tools.js");
  await afterPatchResult.AnnotationEditorUIManager.paste(mockClipboardEvent);
  expect(afterPatchResult.AnnotationEditorLayer.createEditor).toHaveBeenCalled();
});