it("should support pasting an image from clipboard in editing mode", async () => {
  const { AnnotationEditorUIManager } = await import("../../src/display/editor/tools.js");
  const { StampEditor } = await import("../../src/display/editor/stamp.js");
  const { AnnotationEditorLayer } = await import("../../src/display/editor/annotation_editor_layer.js");

  // Mock DOM elements and dependencies
  const container = document.createElement("div");
  const viewer = { get pages() { return [{}]; } };
  const eventBus = { _on: () => {}, _off: () => {} };
  const pdfDocument = { annotationStorage: {} };
  const pageColors = {};

  // Initialize UI manager
  const uiManager = new AnnotationEditorUIManager(container, viewer, eventBus, pdfDocument, pageColors);

  // Create a mock layer with editors
  const layer = new AnnotationEditorLayer({
    uiManager: uiManager,
    pageIndex: 0,
    div: container,
    accessibilityManager: {},
    annotationLayer: {},
    viewport: {},
    l10n: {},
  });

  // Mock current layer and editor types
  uiManager.currentLayer = layer;
  uiManager.registerEditorTypes([StampEditor]);

  // Mock clipboard event with image data
  const clipboardData = {
    items: [
      new DataTransferItem(
        "image/png",
        new File(["data:image/png;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cG9seWdvbiBwb2ludHM9IjUwLDAgMTAwLDUwIDUwLDEwMCAwLDUwIiBmaWxsPSIjZmZmIi8+PC9zdmc+"], "red-dot.png")
      )
    ],
    getData: () => "image/png"
  };

  // Simulate paste event
  const event = { clipboardData, preventDefault: () => {} };
  uiManager.paste(event);

  // Verify that a new StampEditor was created and added to the layer
  expect(layer.editors.size).toBeGreaterThan(0);
  const editor = layer.editors.values().next().value;
  expect(editor).toBeInstanceOf(StampEditor);
});