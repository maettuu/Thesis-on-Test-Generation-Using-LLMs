it("should correctly create filter URLs with base href", async () => {
  const { DOMFilterFactory } = await import("../../src/display/display_utils.js");
  const { document } = await import("../../src/shared/util.js");

  // Mock document with base href
  const mockDocument = {
    ...document,
    baseURI: "http://example.com/",
    createElementNS: jest.fn(),
    getElementsByTagName: jest.fn(() => [{ href: "." }]),
  };

  const factory = new DOMFilterFactory({ ownerDocument: mockDocument });
  const filter = await factory.addFilter([new Array(256).fill(0)]);

  expect(filter).toMatch(/^url\(http:\/\/example\.com\/#.+?\)$/);
});