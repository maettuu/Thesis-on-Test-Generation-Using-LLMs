it("should correctly serialize and deserialize highlight on cropped pdf", async () => {
  const { getDocument } = await import("../../src/display/api.js");
  const { buildGetDocumentParams } = await import("./test_utils.js");
  const loadingTask = getDocument(buildGetDocumentParams('bug1872721.pdf'));
  const pdfDocument = await loadingTask.promise;
  const pdfPage = await pdfDocument.getPage(1);

  // Create highlight annotation
  const highlight = new (await import("../../src/display/editor/highlight.js")).HighlightEditor({
    color: "#fff066",
    opacity: 1,
    boxes: [{ x: 0.1, y: 0.1, width: 0.2, height: 0.2 }],
    pageIndex: 0,
    page: pdfPage,
    parent: null,
    uiManager: null,
  });

  // Serialize the highlight
  const serialized = highlight.serialize();

  // Deserialize the highlight
  const deserialized = HighlightEditor.deserialize(serialized, null, null);

  // Verify the deserialized dimensions
  expect(deserialized.width).toBeCloseTo(0.2);
  expect(deserialized.height).toBeCloseTo(0.2);

  await pdfDocument.close();
});