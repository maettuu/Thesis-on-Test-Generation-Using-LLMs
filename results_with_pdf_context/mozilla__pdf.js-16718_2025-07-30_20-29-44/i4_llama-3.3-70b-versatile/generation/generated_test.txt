it("should save PDF annotations correctly", async () => {
  const { getDocument } = await import('../../src/display/api.js');
  const { buildGetDocumentParams } = await import('./test_utils.js');
  const loadingTask = getDocument(buildGetDocumentParams('bug1844572.pdf'));
  const pdf = await loadingTask.promise;
  const page = await pdf.getPage(1);
  const annotations = await page.getAnnotations();
  const annotationStorage = new Map();
  annotations.forEach(annotation => annotationStorage.set(annotation.id, annotation));
  const newAnnotations = Array.from(annotationStorage.values());
  const updatedPdf = await pdf.saveDocument({ annotationStorage: newAnnotations });
  const updatedPage = await updatedPdf.getPage(1);
  const updatedAnnotations = await updatedPage.getAnnotations();
  expect(updatedAnnotations.length).toBe(annotations.length);
});