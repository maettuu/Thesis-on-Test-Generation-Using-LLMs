it("should save annotations in certain PDFs", async () => {
  const { getDocument } = await import("../../src/display/api.js");
  const { buildGetDocumentParams } = await import("./test_utils.js");

  const loadingTask = getDocument(buildGetDocumentParams("bug1844572.pdf"));
  const pdf = await loadingTask.promise;

  const annotation = {
    type: "text",
    pages: [0],
    content: "Test annotation",
  };

  const firstPage = (await pdf.getPages([0])).shift();
  const annotations = await firstPage.getAnnotationsData();
  await firstPage.addAnnotation(annotation);

  const newDoc = await pdf.save();
  const reloadedPdf = await getDocument({
    ...buildGetDocumentParams("bug1844572.pdf"),
    data: newDoc,
  });

  const reloadedPages = await reloadedPdf.getPages([0]);
  const reloadedAnnotations = await reloadedPages.shift().getAnnotationsData();

  expect(reloadedAnnotations.length).toBeGreaterThan(0);
});