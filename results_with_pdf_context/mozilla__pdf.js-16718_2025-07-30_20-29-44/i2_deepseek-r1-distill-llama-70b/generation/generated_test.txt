it("should save annotations on PDFs with certain structures", async () => {
  const { getDocument } = await import('../../src/display/api.js');
  const { buildGetDocumentParams } = await import('./test_utils.js');

  const loadingTask = getDocument(buildGetDocumentParams('bug1844572.pdf'));
  const { numPages, fingerprint } = await loadingTask.promise;

  const page = await loadingTask.doc.getPage(0);
  const annotations = await page.getAnnotationsData();
  const newAnnotation = {
    type: 'text',
    content: 'Test Annotation',
    x: 10,
    y: 10,
  };

  await page.addAnnotation(newAnnotation);
  const updatedDoc = await loadingTask.doc.saveDocument();

  const loadedDoc = await getDocument({
    data: updatedDoc,
    password: null,
  });

  const loadedPage = await loadedDoc.getPage(0);
  const loadedAnnotations = await loadedPage.getAnnotationsData();

  expect(loadedAnnotations.length).toBe(annotations.length + 1);
});