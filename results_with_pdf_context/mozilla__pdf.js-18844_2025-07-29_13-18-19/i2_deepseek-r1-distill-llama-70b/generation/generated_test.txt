it("should use Calibri and Lucida Console on Windows and Firefox", async () => {
  const { TextLayer, FeatureTest } = await import("../../src/display/text_layer.js");

  // Mock the platform to be Windows and Firefox
  const mockPlatform = {
    isWindows: true,
    isFirefox: true,
  };
  jest.spyOn(FeatureTest, "platform", "get").mockReturnValue(mockPlatform);

  // Create a TextLayer instance
  const textLayer = new TextLayer({
    textContentSource: new ReadableStream({
      start(controller) {
        controller.enqueue("test");
        controller.close();
      },
    }),
    container: document.createElement("div"),
    viewport: {
      scale: 1,
      rotation: 0,
      rawDims: {
        pageWidth: 100,
        pageHeight: 100,
        pageX: 0,
        pageY: 0,
      },
    },
  });

  // Get the fontFamilyMap
  const fontFamilyMap = TextLayer.fontFamilyMap;

  // Verify the expected fonts
  expect(fontFamilyMap.get("sans-serif")).toContain("Calibri");
  expect(fontFamilyMap.get("monospace")).toContain("Lucida Console");
});