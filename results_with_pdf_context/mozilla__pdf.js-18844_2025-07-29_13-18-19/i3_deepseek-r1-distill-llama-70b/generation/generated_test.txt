it("should use correct font families on Windows", async () => {
  const { TextLayer } = await import("../../src/display/text_layer.js");
  const { FeatureTest } = await import("../../src/shared/util.js");

  // Mock platform detection for Windows and Firefox
  const originalPlatform = FeatureTest.platform;
  FeatureTest.platform = () => ({
    isMac: false,
    isWindows: true,
    isFirefox: true,
  });

  // Test content with specific font families
  const textContent = {
    items: [
      {
        type: "text",
        str: "Sample text",
        fontName: "sans-serif",
        fontSize: 30,
        fontSubstitution: true,
      },
      {
        type: "text",
        str: "Monospace text",
        fontName: "monospace",
        fontSize: 30,
        fontSubstitution: true,
      },
    ],
  };

  // Render the text layer
  const container = document.createElement("div");
  const viewport = {
    scale: 1,
    rawDims: { pageWidth: 100, pageHeight: 100 },
    rotation: 0,
  };
  const textLayer = new TextLayer({ textContentSource: textContent, container, viewport });
  await textLayer.render();

  // Verify font families are correctly applied
  const sansSerifFont = textLayer.textDivs[0].style.fontFamily;
  const monospaceFont = textLayer.textDivs[1].style.fontFamily;

  expect(sansSerifFont).toContain("Calibri");
  expect(monospaceFont).toContain("Lucida Console");

  // Cleanup
  FeatureTest.platform = originalPlatform;
  container.remove();
});