it("should render text with document fonts disabled", async () => {
  const { getDocument } = await import("../../src/display/api.js");
  const { buildGetDocumentParams } = await import("./test_utils.js");
  const pdf = "issue20065.pdf";
  const loadingTask = getDocument(buildGetDocumentParams(pdf));

  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");

  // Mock browser.display.use_document_fonts = 0
  globalThis.browser = {
    display: {
      use_document_fonts: 0,
    },
  };

  const pdfDocument = await loadingTask.promise;
  const pdfPage = await pdfDocument.getPage(1);
  await pdfPage.startRendering({
    canvasContext: ctx,
    viewport: pdfPage.getViewport({ scale: 1 }),
  });

  const expectedCanvasData = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";
  const actualCanvasData = canvas.toDataURL();

  expect(actualCanvasData).toBe(expectedCanvasData);
});