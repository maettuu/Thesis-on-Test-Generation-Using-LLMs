it("should set roleimg on the image canvas when an image is added", async () => {
  const { StampEditor } = await import("../../src/display/editor/stamp.js");
  const parent = {
    pageIndex: 0,
    viewport: {
      rotation: 0,
      rawDims: { pageWidth: 800, pageHeight: 600, pageX: 0, pageY: 0 }
    },
    get parentDimensions() { return [1, 1]; }
  };
  const uiManager = {
    useNewAltTextWhenAddingImage: true,
    useNewAltTextFlow: false,
    _signal: new AbortController().signal,
    enableWaiting: () => {},
    delete: () => {},
    viewParameters: { rotation: 0 }
  };
  const params = {
    parent,
    id: "testEditor",
    uiManager,
    bitmapUrl: "dummy",
    bitmapFile: null
  };
  const editor = new StampEditor(params);
  // Create a dummy container div if not already created.
  if (!editor.div) {
    editor.div = document.createElement("div");
  }
  // Provide minimal stub for addAltTextButton to prevent errors.
  if (typeof editor.addAltTextButton !== "function") {
    editor.addAltTextButton = () => {};
  }
  // Provide addContainer if not already available.
  if (typeof editor.addContainer !== "function") {
    editor.addContainer = function(container) {
      const toolbarDiv = this._editToolbar && this._editToolbar.div;
      if (toolbarDiv) {
        toolbarDiv.before(container);
      } else {
        this.div.appendChild(container);
      }
    };
  }
  editor.render();
  const canvas = editor.div.querySelector("canvas");
  if (!canvas) {
    throw new Error("Canvas element was not added to the editor.");
  }
  if (canvas.getAttribute("role") !== "img") {
    throw new Error("Expected canvas to have role='img', but got: " + canvas.getAttribute("role"));
  }
});
