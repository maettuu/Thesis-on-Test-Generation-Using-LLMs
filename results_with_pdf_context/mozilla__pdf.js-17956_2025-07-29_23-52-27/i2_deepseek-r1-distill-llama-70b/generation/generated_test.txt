it("should throw JpxError with OpenJPEG error message", async () => {
  const { JpxImage } = await import("../../src/core/jpx.js");
  const { OpenJPEG } = await import("../../external/openjpeg/openjpeg.js");

  // Mock the OpenJPEG module to return an error string
  const mockOpenJPEG = {
    decode: jest.fn((data, ignoreColorSpace) => {
      return "OpenJPEG: Unknown format";
    })
  };

  // Set the mock as the OpenJPEG module
  JpxImage.#module = mockOpenJPEG;

  // Use invalid data to trigger the error
  const invalidData = new Uint8Array([0x00, 0x00, 0x00, 0x00]);

  // Test that the error is correctly thrown and includes OpenJPEG message
  const error = await JpxImage.decode(invalidData, false).catch(err => err);
  expect(error.message).toBe("OpenJPEG: Unknown format");
});