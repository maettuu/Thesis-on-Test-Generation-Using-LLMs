it("should respect verbosity levels for OpenJPEG warnings", async () => {
  const mockWarn = jest.fn();
  const originalWarn = console.warn;

  const { warn: utilWarn } = await import("../../src/shared/util.js");
  utilWarn.mockImplementation(mockWarn);

  const data = new Uint8Array();

  setVerbosityLevel(VerbosityLevel.error);
  try {
    await JpxImage.decode(data);
  } catch (error) {
    // Expected to throw an error
  }
  expect(mockWarn).not.toHaveBeenCalled();

  mockWarn.mockClear();

  setVerbosityLevel(VerbosityLevel.info);
  try {
    await JpxImage.decode(data);
  } catch (error) {
    // Expected to throw an error
  }
  expect(mockWarn).toHaveBeenCalled();

  console.warn = originalWarn;
});