it("should respect verbosity level for OpenJPEG warnings", async () => {
  const { warn: utilWarn, setVerbosityLevel } = await import("../../src/shared/util.js");
  const { JpxImage } = await import("../../src/core/jpx.js");

  const mockWarn = jest.fn();
  const originalWarn = console.warn;
  console.warn = mockWarn;

  // Set verbosity to 0 to suppress warnings
  setVerbosityLevel(0);

  const testData = new Uint8Array([0x00, 0x00, 0x00, 0x00]); // Data that triggers a warning

  // Should not trigger a warning due to suppressed verbosity
  await JpxImage.decode(testData);
  expect(mockWarn).not.toHaveBeenCalled();

  // Reset to default verbosity
  setVerbosityLevel(1);

  // Should trigger a warning now
  await JpxImage.decode(testData);
  expect(mockWarn).toHaveBeenCalled();

  console.warn = originalWarn;
});