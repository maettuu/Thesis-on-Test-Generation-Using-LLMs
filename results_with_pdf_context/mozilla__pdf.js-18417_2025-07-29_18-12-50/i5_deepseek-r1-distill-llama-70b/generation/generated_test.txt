it("should generate correct filter URLs with base href", async () => {
  const { DOMFilterFactory } = await import("../../src/display/display_utils.js");

  // Mock document and window to simulate <base href> presence
  const mockDocument = {
    URL: "http://example.com/",
    baseURI: "http://example.com/other",
    createElement: () => ({})
  };
  const mockWindow = { document: mockDocument };

  // Create filter factory with mocked window
  const factory = new DOMFilterFactory(mockWindow);

  // Create a test filter
  const filter = await factory.createFilter({});

  // Verify the URL includes the base href
  expect(filter.url).toMatch(/http:\/\/example.com\/#/);
});