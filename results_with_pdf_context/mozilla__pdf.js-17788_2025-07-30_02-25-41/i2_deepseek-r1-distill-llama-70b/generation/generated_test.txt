it("should have accessible highlighted text for screen readers", async () => {
  const { PDFDocument } = await import("../../src/display/api.js");
  const { PDFPage } = await import("../../src/display/display_utils.js");
  const { TextLayer } = await import("../../src/display/text_layer.js");
  const { HighlightEditor } = await import("../../src/display/editor/highlight.js");

  // Create a simple PDF with a page containing text
  const pdf = new PDFDocument({
    content: [
      "1 0 0 1 0 0 cm",
      "/F1 12 Tf",
      "(Hello World!) Tj",
      "ET",
    ],
  });

  const page = new PDFPage(pdf, 0);
  const textLayer = new TextLayer({
    pageIndex: 0,
    container: document.createElement("div"),
  });

  // Render the text layer
  await textLayer.render();

  // Create a selection for the highlighted text
  const selection = document.getSelection();
  selection.removeRange(selection.getRangeAt(0));
  const range = document.createRange();
  range.selectNodeContents(textLayer.div);
  selection.addRange(range);

  // Create the highlight editor
  const highlightEditor = new HighlightEditor({
    anchorNode: range.startContainer,
    anchorOffset: 0,
    focusNode: range.endContainer,
    focusOffset: range.endOffset,
    boxes: [],
    methodOfCreation: "keyboard",
    text: "Hello World!",
  });

  // Render the highlight editor
  const highlightDiv = highlightEditor.render();

  // Check for the accessible text element
  const markElement = highlightDiv.querySelector("mark.visuallyHidden");
  expect(markElement).toBeTruthy();
  expect(markElement.textContent).toBe("Hello World!");
});