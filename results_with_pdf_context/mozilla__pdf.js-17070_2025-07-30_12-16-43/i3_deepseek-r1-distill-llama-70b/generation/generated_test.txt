it("should render popup annotations as HTML", async () => {
  const { getDocument } = await import("../../src/display/api.js");
  const { buildGetDocumentParams } = await import("./test_utils.js");
  const loadingTask = getDocument(buildGetDocumentParams('issue17069.pdf'));

  const pdfDocument = await loadingTask;
  const pdfPage = await pdfDocument.getPage(0);
  const annotations = await pdfPage.getAnnotations();

  let popupAnnotationCount = 0;

  for (const annotation of annotations) {
    const { subtype } = await annotation.get_data();
    if (subtype === AnnotationType.POPUP) {
      popupAnnotationCount++;
      const html = await annotation.get_html();
      assert(html.length > 0, "Popup annotation HTML is empty");
    }
  }

  assert(popupAnnotationCount > 0, "No popup annotations found");
});