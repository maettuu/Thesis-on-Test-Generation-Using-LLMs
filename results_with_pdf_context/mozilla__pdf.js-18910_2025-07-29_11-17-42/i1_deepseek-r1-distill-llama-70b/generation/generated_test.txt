it("should use ImageDecoder for JPEG images", async () => {
  const { PDFImage } = await import("../../src/core/image.js");
  const { JpegStream } = await import("../../src/core/jpeg_stream.js");
  const { JpegImage } = await import("../../src/core/jpg.js");
  const { XRefMock } = await import("./test_utils.js");

  const xref = new XRefMock();
  const data = new Uint8Array([
    0xff, 0xd8, 0xff, 0xe0, 0x00, 0x10, 0x4a, 0x46, 0x49, 0x46, 0x00, 0x01,
    0x01, 0x00, 0x00, 0x00, 0x00, 0xff, 0xfe, 0x00, 0x1d, 0x54, 0x68,
    0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x61, 0x20, 0x74, 0x65, 0x73,
    0x74, 0x20, 0x4a, 0x50, 0x45, 0x47, 0x20, 0x69, 0x6d, 0x61, 0x67,
    0x65, 0x2e, 0xff, 0xd9
  ]);

  const stream = new JpegStream(new BaseStream(), data.length, {});
  const image = new PDFImage({
    xref,
    res: {},
    image: stream,
    isInline: true,
  });

  const result = await image.getImageBytes();
  expect(result).toBeTruthy();
});