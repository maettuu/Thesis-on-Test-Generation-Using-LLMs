it("should delete selected annotation when Delete key is pressed on macOS", async () => {
  const { PDFDocument, Annotation } = await import("../../src/core/document.js");
  const { buildGetDocumentParams } = await import("./test_utils.js");

  // Create a PDF document with one page containing an annotation
  const pdfDoc = await PDFDocument.load(
    buildGetDocumentParams("test.pdf", new Uint8Array())
  );
  const page = (await pdfDoc.getPage(1));
  const annotation = new Annotation();
  page.addAnnotation(annotation);

  // Set up the annotation editor
  const editorManager = new AnnotationEditorUIManager(
    document.createElement("div"),
    {
      _on: () => {},
      _off: () => {},
      _dispatch: () => {},
    },
    pdfDoc,
    new Map()
  );

  // Select the annotation
  editorManager.selectAnnotation(annotation);

  // Simulate pressing Delete key on macOS (meta + Delete)
  const event = new KeyboardEvent("keydown", {
    key: "Delete",
    code: "Delete",
    metaKey: true,
  });

  // Dispatch the event
  editorManager.element.dispatchEvent(event);

  // Verify that the annotation was deleted
  expect(page.getAnnotations().length).toBe(0);
});