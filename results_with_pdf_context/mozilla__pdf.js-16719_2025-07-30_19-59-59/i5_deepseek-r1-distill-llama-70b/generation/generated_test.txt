it("should delete selected annotation when Delete key is pressed on macOS", async () => {
  const { PDFDocument } = await import("../../src/core/document.js");
  const { Annotation } = await import("../../src/core/annotation.js");
  const { AnnotationEditorUIManager } = await import("../../src/display/editor/tools.js");

  // Load test PDF
  const pdf = await PDFDocument.load(await fetch("test.pdf").then(res => res.arrayBuffer()));

  // Create annotation
  const annotation = new Annotation({
    type: Annotation.Type.MARKUP,
    subtype: Annotation.Type.UNDERLINE,
    quads: [[10, 10, 20, 10, 20, 20, 10, 20]],
    page: 0
  });

  // Add annotation to first page
  const page = await pdf.getPage(1);
  page.addAnnotation(annotation);

  // Set up UI manager
  const uiManager = new AnnotationEditorUIManager({
    document: pdf,
    page: page,
    annotation: annotation,
    container: document.createElement('div')
  });

  // Simulate Delete key press on macOS
  const event = new KeyboardEvent('keydown', {
    key: 'Delete',
    keyCode: 8, // Mac Delete key code
    isComposing: false
  });

  // Trigger the keydown event
  uiManager.container.dispatchEvent(event);

  // Verify annotation was removed
  expect(page.getAnnotations().length).toBe(0);
});