it("should highlight and comment the text selection in a pdf", async () => {
  const { AnnotationEditorUIManager } = await import("../../src/display/editor/tools.js");
  const { PDFDocumentProxy } = await import("../../src/display/api.js");

  const mockCommentManager = { destroy: jest.fn() };
  const mockUIManager = new AnnotationEditorUIManager(
    document.createElement("div"),
    document.createElement("div"),
    document.createElement("div"),
    null,
    mockCommentManager,
    null,
    null,
    null,
    null,
    null,
    null,
    true,
    false,
    false,
    null,
    null,
    false
  );

  const mockSelection = {
    isCollapsed: false,
    toString: () => "selected text",
    anchorNode: document.createElement("div"),
    anchorOffset: 0,
    focusNode: document.createElement("div"),
    focusOffset: 12,
    empty: jest.fn(),
  };

  document.getSelection = jest.fn().mockReturnValue(mockSelection);
  mockUIManager.highlightSelection = jest.fn();
  mockUIManager.commentSelection("context_menu");

  expect(mockUIManager.highlightSelection).toHaveBeenCalledWith("context_menu", true);
});