it("should handle missing cidSystemInfo gracefully in composite fonts", async () => {
  const { createIdFactory } = await import("./test_utils.js");
  const evaluator = new (await import("../../src/core/evaluator.js")).PartialEvaluator({
    xref: {},
    handler: {},
    pageIndex: 0,
    idFactory: createIdFactory(),
    fontCache: new Map(),
    builtInCMapCache: new Map(),
    standardFontDataCache: new Map(),
    globalImageCache: new Map(),
    systemFontCache: new Map(),
  });
  const properties = {
    composite: true,
    cMap: { builtInCMap: false },
    firstChar: 32,
    lastChar: 127,
    // Intentionally omitting cidSystemInfo to simulate problematic PDFs.
  };
  const toUnicodeMap = await evaluator.buildToUnicode(properties);
  if (typeof toUnicodeMap.lookup !== "function") {
    throw new Error("toUnicodeMap.lookup is not a function");
  }
  const char = toUnicodeMap.lookup(65);
  if (char !== "A") {
    throw new Error(`Expected "A" for char code 65 but got "${char}"`);
  }
});